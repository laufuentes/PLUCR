% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/alternated_procedure.R
\name{Optimization_Estimation}
\alias{Optimization_Estimation}
\title{Iterative Optimization Procedure}
\usage{
Optimization_Estimation(
  mu0,
  nu0,
  prop_score,
  X,
  A,
  Y,
  Xi,
  lambda,
  alpha = 0.1,
  precision = 0.05,
  beta = 0.05,
  centered = FALSE,
  tol = 2.5 * 0.01,
  max_iter = 5,
  root.path
)
}
\arguments{
\item{mu0}{A fold-specific function predicting primary outcome (Y) given treatment (A) and covariates (X).}

\item{nu0}{A fold-specific function predicting adverse event outcome (Xi) given treatment (A) and covariates (X).}

\item{prop_score}{A function that estimates the propensity score given treatment (A) and covariates (X).}

\item{X}{A matrix of covariates of size n x d (input data).}

\item{A}{A binary vector or matrix of length n indicating treatment assignment (0 or 1).}

\item{Y}{A numeric vector or matrix of length n representing primary outcomes (in \link{0, 1}).}

\item{Xi}{A numeric vector or matrix of length n indicating adverse events (0 or 1).}

\item{lambda}{A non-negative numeric scalar controlling the penalty for violating the constraint.}

\item{alpha}{A numeric scalar representing the constraint tolerance (0.1 by default).}

\item{precision}{A numeric scalar defining the desired convergence precision (0.05 by default). The number of Frank-Wolfe iterations (K) is inversely proportional to this value, calculated as 1/precision.}

\item{beta}{A non-negative numeric scalar controlling the sharpness of the probability function (0.05 by default).}

\item{centered}{A logical value indicating whether to apply centering in \code{sigma_beta} (FALSE by default).}

\item{tol}{A numeric scalar used as an early stopping criterion based on the RMSE between consecutive solutions (0.025 by default).}

\item{max_iter}{A numeric scalar specifying the maximum number of iterations (5 by default).}

\item{root.path}{Path to the folder where all results are to be saved.}
}
\value{
A list containing:
\item{iter}{The number of completed iterations.}
\item{offset_mu}{Initial logit-transformed outcome predictions.}
\item{offset_nu}{Initial logit-transformed auxiliary predictions.}
\item{psi_collection}{Matrix of covariate projections across iterations.}
\item{sigma_psi_collection}{Matrix of transformed projections across iterations.}
\item{epsilon1}{GLM coefficients from the outcome model.}
\item{epsilon2}{GLM coefficients from the auxiliary model.}
\item{theta_collection}{List of parameter vectors from each iteration of the functional weight estimation.}
}
\description{
This function performs an iterative optimization routine to correct and minimize the objective function.
It iteratively finds a solution and corrects the objective function for such optimal solution, until
two consecutive solutions do not change much.
}
\details{
This function saves intermediate results to files in order to recover progress or inspect iteration-level behavior.
If the optimization converges or the maximum number of iterations is reached, the final parameter vector \code{theta_init} is saved.
}
\examples{
# (Requires user-defined functions: mu0, nu0, prop_score, FW, make_psi, sigma_beta, update_mu_XA, update_nu_XA)
# Optimization_Estimation(mu0, nu0, prop_score, df, lambda=1, alpha=0.1, precision=0.025,
#                         beta=0.05, centered=TRUE, folder="path/to/folder", prefix="run1")

}
